# File: infra/pgbouncer.ini

[databases]
# Format: dbname_lokal = host=host_asli port=port_asli dbname=dbname_asli sslmode=require
#
# Ganti dengan detail koneksi Supabase Anda yang sebenarnya
# PENTING: Tambahkan 'sslmode=require' agar Supabase mau menerima koneksi.
potentia_db = host=db.abcdefg.supabase.co port=5432 dbname=postgres sslmode=require

[pgbouncer]
# Koneksi pool
pool_mode = transaction
max_client_conn = 200
default_pool_size = 20
min_pool_size = 5
reserve_pool_size = 5
reserve_pool_timeout = 5
max_db_connections = 50
max_user_connections = 50

# Timeout (Sama seperti file Anda)
server_reset_query = DISCARD ALL
server_check_delay = 30
server_check_query = select 1
server_lifetime = 3600
server_idle_timeout = 600

# Logging (Path disesuaikan untuk Docker)
logfile = /var/log/pgbouncer/pgbouncer.log
syslog = 0
verbose = 0
listen_addr = 0.0.0.0
listen_port = 6432

# Admin (Sama seperti file Anda)
admin_users = pgbouncer_admin
stats_users = pgbouncer_stats

# Security (Sama seperti file Anda)
auth_type = md5
auth_file = /etc/pgbouncer/userlist.txt