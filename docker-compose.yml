# File: docker-compose.yml
# (FINAL - PgBouncer telah dihapus, beralih ke Supavisor via DATABASE_URL)

version: '3.8'

services:
  backend-1:
    build:
      context: ./backend # Asumsi Dockerfile Anda ada di folder backend
      dockerfile: Dockerfile
    container_name: potentia_backend
    ports:
      - "8000:8000"
    volumes:
      - ./backend:/app # Sinkronisasi kode untuk pengembangan
    # 'env_file' tidak diperlukan jika Anda menggunakan Codespaces Secrets
    # env_file:
    #   - ./backend/.env
    depends_on:
      - redis-1
    restart: unless-stopped
    # Pastikan 'backend-1' berada di jaringan yang sama dengan 'redis-1'
    # (Biasanya default, tapi 'networks' eksplisit lebih aman)
    networks:
      - potentia-net

  redis-1:
    # Menggunakan image Redis standar (seperti yang terlihat di log Anda)
    image: redis:latest
    container_name: potentia_redis
    ports:
      - "6379:6379"
    restart: unless-stopped
    networks:
      - potentia-net


networks:
  potentia-net:
    driver: bridge